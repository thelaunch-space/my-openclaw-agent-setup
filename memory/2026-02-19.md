# 2026-02-19 - Post-Update Recovery

## What Happened Today

### Morning: Major Infrastructure Changes
1. **Tailscale setup** - HTTPS via Tailscale Serve at `https://srv1331841.tail4447a0.ts.net/`
2. **Docker port lockdown** - 127.0.0.1 binding only
3. **allowInsecureAuth: false** - Enabled with HTTPS
4. **OpenClaw update** - v2026.2.2 → v2026.2.17
5. **Container recreation** - Wiped workspace files

### What Was Lost
- `/home/node/openclaw/credentials/` directory (google-service-account.json, github-token.txt, convex-api-key.txt)
- `/home/node/openclaw/node_modules/` (googleapis package)
- `/home/node/openclaw/package.json`
- Memory files for Feb 18-19
- Vibhishana briefs directory

### What Krishna Restored from Local Backup
- All agent workspace files (AGENTS.md, IDENTITY.md, SOUL.md, TOOLS.md, USER.md, MEMORY.md)
- All workflow files
- All 6 helper scripts
- Templates

### What's Still Missing (CRITICAL)
1. **Credentials directory** - Must be recreated with all 3 files
2. **npm packages** - Need `npm init -y && npm install googleapis`
3. **Vibhishana briefs directory** - Need to recreate `/home/node/openclaw/vibhishana/briefs/`

### Cron Errors Post-Update
- "cron delivery target is missing" on SEO Brief #2, Vidura Midday Strategy
- Likely caused by sessions not existing after container recreation
- Should self-heal on next successful run

### Persistence Issue - RESOLVED ✅
- **Fixed:** Workspace at `/home/node/openclaw/` is NOW volume-mounted to VPS host
- Config at `/home/node/.openclaw/` also mounted (was already)
- Future container updates will NOT wipe workspace files

## Action Items
- [x] Krishna to restore credentials from local backup ✅ Done
- [x] Run `npm init -y && npm install googleapis` in workspace ✅ Done
- [x] Create `/home/node/openclaw/vibhishana/briefs/` directory ✅ Done
- [x] Install convex-push skills to ~/.openclaw/skills/ ✅ Done
- [x] Verify Convex API key (was wrong key - deploy key vs AGENT_API_KEY) ✅ Fixed
- [x] Verify helper scripts work ✅ All passed
- [x] **Docker volume mount fixed** ✅ Workspace now mounted to VPS host - ROOT CAUSE FIX
- [x] **File permissions fixed** ✅ `chown -R node:node` - all agents can write to their docs

---

## Recovery Verification (09:52 UTC)

All systems verified operational:

| Test | Result |
|------|--------|
| Google Sheets (sheets-helper.js) | ✅ Loaded |
| Valmiki sheets | ✅ 13 posts visible |
| Vyasa sheets | ✅ 35 blog-queue entries |
| Vidura sheets | ✅ Loaded |
| Convex push | ✅ Working (after key fix) |
| Convex skills | ✅ All 4 at ~/.openclaw/skills/ |
| GitHub token | ✅ Present |

---

## Full Incident Debrief

**Timeline (all times IST):**

| Time | Event |
|------|-------|
| Morning | Tailscale installed on VPS host for HTTPS access to Control UI |
| Morning | New URL: https://srv1331841.tail4447a0.ts.net/ |
| Morning | I (Parthasarathi) suggested `tailscale.mode: "serve"` in config |
| Morning | **CRASH** - Gateway crashed. Tailscale runs on HOST, not container |
| Morning | Docker port changed: 127.0.0.1:${PORT}:${PORT} (public 41473 closed) |
| Morning | allowInsecureAuth: false enabled (works with HTTPS via Tailscale) |
| Morning | OpenClaw updated: v2026.2.2 → v2026.2.17 |
| Morning | `docker compose down && up` wiped /home/node/openclaw/ |
| Afternoon | Krishna restored all files from local Mac backups |
| 15:17 | System restoration tests completed, all passed |

**What Was Lost:**
- All workspace files, scripts, credentials, workflows, templates, skills
- Memory files (had to be restored from backup)
- npm packages (googleapis)

**Root Cause:**
`/home/node/openclaw/` is inside the container, NOT volume-mounted.
Only `/home/node/.openclaw/` (config) is persistent.

**Lesson Learned:**
NEVER set `tailscale.mode` inside OpenClaw config. Tailscale runs on the host OS, not in the container. This crashed the gateway.

**Batman Agent Config:**
Deleted during recovery (leftover from Lucy era).

---

## Today's Output Check

**What Delivered Successfully:**

| Time | Agent | Output |
|------|-------|--------|
| 03:31 UTC | Vibhishana | Morning Reddit Scan - 46 new questions |
| 05:36 UTC | Vyasa | PR #25 "Why Most Founders Fail at Distribution" + Convex push ✅ |
| 05:46 UTC | Vibhishana | SEO Brief #1 "First Sale Taking Forever" + Convex push ✅ |

**What Failed (delivery target missing):**

| Time | Agent | Job | Error |
|------|-------|-----|-------|
| 2:00 PM | Vibhishana | Brief #2 | cron delivery target is missing |
| 2:30 PM | Vidura | Midday Strategy | cron delivery target is missing |
| 3:00 PM | Vyasa | Citation Enrichment #1 | cron delivery target is missing |

**Impact:** 3 jobs failed due to container restart disrupting session state.

**Prognosis:** Should self-heal on next run. Monitoring remaining jobs.

---

## Remaining Today

| Time (IST) | Agent | Job |
|------------|-------|-----|
| 4:30 PM | Vibhishana | Brief #3 |
| 5:00 PM | Vyasa | Citation Enrichment #2 |
| 6:00 PM | Vibhishana | Evening Report |
| 7:00 PM | Parthasarathi | Due Diligence |
| 7:30 PM | Vidura | Evening Review |
| 8:00 PM | Valmiki | Daily Observation |
| 8:00 PM | Vyasa | Citation Enrichment #3 |
| 9:00 PM | Valmiki | Ping Krishna |
